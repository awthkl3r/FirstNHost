(function(i,c){typeof exports=="object"&&typeof module!="undefined"?c(exports,require("graphql")):typeof define=="function"&&define.amd?define(["exports","graphql"],c):(i=typeof globalThis!="undefined"?globalThis:i||self,c(i["@nhost/graphql-js"]={},i.graphql))})(this,function(i,c){"use strict";function g(r){var e=r.default;if(typeof e=="function"){var n=function s(){if(this instanceof s){var t=[null];t.push.apply(t,arguments);var l=Function.bind.apply(e,t);return new l}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var t=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(n,s,t.get?t:{enumerable:!0,get:function(){return r[s]}})}),n}function b(r,e){return e=e||{},new Promise(function(n,s){var t=new XMLHttpRequest,l=[],p=[],a={},d=function(){return{ok:(t.status/100|0)==2,statusText:t.statusText,status:t.status,url:t.responseURL,text:function(){return Promise.resolve(t.responseText)},json:function(){return Promise.resolve(t.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([t.response]))},clone:d,headers:{keys:function(){return l},entries:function(){return p},get:function(u){return a[u.toLowerCase()]},has:function(u){return u.toLowerCase()in a}}}};for(var h in t.open(e.method||"get",r,!0),t.onload=function(){t.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(u,o,f){l.push(o=o.toLowerCase()),p.push([o,f]),a[o]=a[o]?a[o]+","+f:f}),n(d())},t.onerror=s,t.withCredentials=e.credentials=="include",e.headers)t.setRequestHeader(h,e.headers[h]);t.send(e.body||null)})}const m=g(Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"})));var v=self.fetch||(self.fetch=m.default||m);function T(r,e,n){return r.document?r:{document:r,variables:e,config:n}}function y(r){var s;let e;const n=r.definitions.filter(t=>t.kind==="OperationDefinition");return n.length===1&&(e=(s=n[0].name)==null?void 0:s.value),e}function q(r){if(typeof r=="string"){let n;try{const s=c.parse(r);n=y(s)}catch{}return{query:r,operationName:n}}const e=y(r);return{query:c.print(r),operationName:e}}class w{constructor(e){const{url:n,adminSecret:s}=e;this._url=n,this.accessToken=null,this.adminSecret=s}async request(e,...n){const[s,t]=n,l=T(e,s,t),{headers:p,...a}=t||{},{query:d,operationName:h}=q(l.document);try{const u=await v(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:h,query:d,variables:s}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...p},...a});if(!u.ok)return{data:null,error:{error:u.statusText,message:u.statusText,status:u.status}};const{data:o,errors:f}=await u.json();return f?{data:null,error:f}:typeof o!="object"||Array.isArray(o)||o===null?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:o,error:null}}catch(u){const o=u;return{data:null,error:{message:o.message,status:o.name==="AbortError"?0:500,error:o.name==="AbortError"?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}i.NhostGraphqlClient=w,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=graphql-js.umd.js.map
